[{"title":"","url":"/posts/0/","content":"## 编译内核\n\n安装软件\n\n```shell\nsudo apt install gcc make libncurses5-dev openssl libssl-dev build-essential pkg-config libc6-dev bison flex libelf-dev dwarves bc -y\n```\n\n在 https://mirrors.tuna.tsinghua.edu.cn/kernel/ 下载源码 `wget`\n\n解压`tar xvzf linux-6.4.tar.gz`\n\n修改`.config`\n\n```shell\ncp /boot/config-$(uname -r) .config\nvim .config\n  CONFIG_SYSTEM_TRUSTED_KEYS=\"\"\n  CONFIG_SYSTEM_REVOCATION_KEYS=\"\"\nmake menuconfig\n```\n\n编译\n\n```shell\nmake -j $(nproc)\n```\n\n安装内核模块 (通过设置 `INSTALL_MOD_STRIP=1`，可以在安装内核模块时去除不必要的符号信息，减小模块大小)\n\n```shell\nsudo make INSTALL_MOD_STRIP=1 modules_install -j $(nproc)\n```\n\n安装内核`boot.img`\n\n```shell\nsudo make install\n```\n\n## 替换内核\n\n内核编译完成后，默认启用`menuentry`第一项，如果要修改为指定版本：\n\n```shell\ncat /boot/grub/grub.cfg | grep menuentry\n```\n\n找到要更换的内核名字：\n\n![img](https://cdn.nlark.com/yuque/0/2024/png/23099406/1711505651016-2898dc83-58dc-4cdd-9dcc-4da5de1762b9.png)\n\n修改`GRUB_DEFAULT` 为刚刚复制的内核名字：\n\n```shell\nvim /etc/default/grub\n```\n\n提示要用更新的名字：\n\n![img](https://cdn.nlark.com/yuque/0/2024/png/23099406/1711505783689-354da9c1-ac04-4a2b-8dcf-cb8af5ff319f.png)\n\n将`GRUB_DEFAULT`替换为上述名字，执行：\n\n```shell\nsudo update-grub\nsudo update-grub2\n```\n\n重启，`uname -r`显示为新内核\n\n## 删除内核相关文件\n\n```shell\nfind /boot/vm*\nrm -rf /boot\nrm -rf /lib/modules\n\nupdate-grub\nupdate-grub2\nmake mrproper\n```\n\n## /etc/default/grub参数\n\n开机显不显示选择内核界面：\n\n```shell\nGRUB_TIMEOUT_STYLE=hidden  \nGRUB_TIMEOUT=10\n```\n\n\n\n## 创建USB启动盘\n\n[Rufus](https://rufus.ie/zh/)","categories":[],"tags":[]},{"title":"Hello World","url":"/posts/16107/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","categories":[],"tags":[]}]